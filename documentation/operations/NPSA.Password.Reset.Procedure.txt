

Generate and update .kbdx.  Make sure to capture the previous password in the notes.
Put AT nodes out of service via GSM.

[Production]
tfsprod01
tfsprod02
prodsqlcl220
prodsql220\sql220
prodsqlrs09
tfsproxy01
tfsscan01
tfssearch01
tfsrm01
sonarqube
tfsbuild01
tfsbuild02
tfsbuild03
tfsbuild04

[QA]
tfsqa01
tfsqa02
prodsqlcl219
prodsql219\sql219
qasqlrs06

[Dev]
tfsdev01
tfsdev02
devsql46
devsql46 (DB)
tfsdevbld01
tfsdevbld02


Disable event mapping via GEMSR.

Broadcast to Team Room.
Stop data warehouse jobs.

Contact help desk and do a manual reset on the necessary passwords.

All AT nodes:
	Stop Health Check web site and stop .NET application pool.
	Run TfsServiceControl QUIESCE on node
	Stop SharePoint Timer service.
	Update TFSSERVICE and TFSREPORTS accounts via TFS Administration Console.  TFS Background Agent service will start on its own.
	Update TFS Health Check website on AT nodes.
	TFSSERVICE credentials need to be updated for TFS HC site application pool.
	Update TFSREPORTS in SSRS for data sources other than the 2 default ones.

	Update SharePoint Central Administration application pool identity credentials.
	Update managed accounts in SharePoint.
		Central administration:  http://tfsprod01:17012/default.aspx (Run IE as administrator)
		Security > Configure managed accounts
		Check - Change password now
		Use existing password, paste password in.
		Do for all managed accounts.
	
Update SharePoint Timer Service service credentials.
Start SharePoint Timer service.
DO NOT tamper with the AppFabric service on either AT node.
Start Health Check .NET application pool and web site.

Restart AT nodes.  One node at a time, starting with 02.
Perform basic testing.
Email broadcast complete > WW-ETFS-Everyone
Enable LB event mapping in GEMSR

Update SSRS Data Sources for administrative reports
Start data warehouse jobs.
Broadcast to Team Room.
Update ETFS .kbdx into TFS.

Fix SPS log folder permissions.
C:\Program Files\Common Files\Microsoft Shared\Web Server Extensions\15
Security > Advanced > Add > Select principal
[Server]\WSS_WPG
[Server]\WSS_Admin_WPG
Full Control

FIXES ********************************************************

SPS PS Fix for AppFabric start failure:
Use SharePoint 2013 Management Shell > Run as Administrator:

Remove-SPDistributedCacheServiceInstance
Add-SPDistributedCacheServiceInstance



***************************************************************

Addtional notes:

$farm = Get-SPFarm
$cacheService = $farm.Services | where {$_.Name -eq "AppFabricCachingService"}
$accnt = Get-SPManagedAccount -Identity "USAC\USFETFSDEVSP2"
$cacheService.ProcessIdentity.CurrentIdentityType = "SpecificUser"
$cacheService.ProcessIdentity.ManagedAccount = $accnt
$cacheService.ProcessIdentity.Update()
$cacheService.ProcessIdentity.Deploy()


$instanceName ="SPDistributedCacheService Name=AppFabricCachingService" 
$serviceInstance = Get-SPServiceInstance | ? {($_.service.tostring()) -eq $instanceName -and ($_.server.name) -eq $env:computername} 
$serviceInstance.Provision()


utsec01
utsec05
tfslinuxbuild01.usac.mmm.com = 169.10.239.80

